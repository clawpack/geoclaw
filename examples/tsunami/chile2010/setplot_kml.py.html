<!-- **** DO NOT EDIT THIS FILE *** 
         This file was generated automatically from file
              setplot_kml.py
         using $CLAW/clawutil/src/python/clawutil/clawcode2html.py         -->

<html>
<title> setplot_kml.py.html </title>


          <head>
           <link rel="icon" href="http://clawpack.github.io//clawicon.ico" />
          </head> 
           <BODY TEXT="#000000" BGCOLOR="#FFFFFF" LINK="#0000FF" 
                 VLINK="#5500DD" ALINK="#FF0000">
           <font FACE="HELVETICA,ARIAL">
           
<!-- Created from the file /Users/hudaqureshi/clawpack/geoclaw/examples/tsunami/chile2010/setplot_kml.py -->
<!-- Date: Wed Jun 14 2017 at 13:29:06 -->

<table bgcolor="#FFEE99"> <tr> <td>
&nbsp;<font size=6> setplot_kml.py.html </font> </td>

            <td><a href="http://clawpack.github.io/doc/index.html"><img
            src="http://clawpack.github.io//clawlogo.jpg"
            width=100 alt="CLAWPACK"></a>&nbsp;&nbsp; </td> </tr> <tr> <td>
&nbsp;Source file: &nbsp;&nbsp;<a href="setplot_kml.py">setplot_kml.py </a>
</td></tr><tr><td>
&nbsp;Directory:  &nbsp; /Users/hudaqureshi/clawpack/geoclaw/examples/tsunami/chile2010 
</td></tr><tr><td>
&nbsp;Converted:  &nbsp; Wed Jun 14 2017 at 13:29:06 
&nbsp; using <a href="http://clawpack.github.io//doc/application_documentation.html#clawcode2html">clawcode2html</a>
</td></tr><tr><td>
<font color="#BB3300"> &nbsp;This documentation file will 
not reflect any later changes in the source file. </font>
</td></tr></table></font>
<p>
<pre> 

"""
Set up the plot figures, axes, and items to be done for each frame.

This module is imported by the plotting routines and then the
function setplot is called to set the plot parameters.

"""

from __future__ import absolute_import
from __future__ import print_function
import numpy as np
import matplotlib.pyplot as plt

from clawpack.geoclaw import topotools
from six.moves import range

try:
    TG32412 = np.loadtxt('32412_notide.txt')
except:
    print("*** Could not load DART data file")

<font color="blue">#--------------------------</font>
def setplot(plotdata):
<font color="blue">#--------------------------</font>

    """
    Specify what is to be plotted at each frame.
    Input:  plotdata, an instance of pyclaw.plotters.data.ClawPlotData.
    Output: a modified version of plotdata.

    """


    from clawpack.visclaw import colormaps, geoplot
    from numpy import linspace

    plotdata.clearfigures()  <font color="blue"># clear any old figures,axes,items data</font>

    plotdata.verbose = False

    <font color="blue"># To plot gauge locations on pcolor or contour plot, use this as</font>
    <font color="blue"># an afteraxis function:</font>

    def addgauges(current_data):
        from clawpack.visclaw import gaugetools
        gaugetools.plot_gauge_locations(current_data.plotdata, \
             gaugenos='all', format_string='ko', add_labels=True)


    <font color="blue">#-----------------------------------------</font>
    <font color="blue"># Some global kml flags</font>
    <font color="blue">#-----------------------------------------</font>
    plotdata.kml_name = "Chile 2010"
    plotdata.kml_starttime = [2010,2,27,6,34,0]  <font color="blue"># Time of event in UTC [None]</font>
    plotdata.kml_tz_offset = 3    <font color="blue"># Time zone offset (in hours) of event. [None]</font>

    plotdata.kml_index_fname = "Chile_2010"  <font color="blue"># name for .kmz and .kml files ["_GoogleEarth"]</font>

    <font color="blue"># Set to a URL where KMZ file will be published.</font>
    <font color="blue"># plotdata.kml_publish = None</font>

    <font color="blue"># Colormap range</font>
    cmin = -0.2
    cmax = 0.2
    cmap = geoplot.googleearth_transparent

    <font color="blue">#-----------------------------------------------------------</font>
    <font color="blue"># Figure for KML files</font>
    <font color="blue">#----------------------------------------------------------</font>
    plotfigure = plotdata.new_plotfigure(name='Sea Surface',figno=1)
    plotfigure.show = True

    plotfigure.use_for_kml = True
    plotfigure.kml_use_for_initial_view = True

    <font color="blue"># These override any axes limits set below in plotaxes</font>
    plotfigure.kml_xlimits = [-120,-60]
    plotfigure.kml_ylimits = [-60, 0.0];

    <font color="blue"># Resolution (should be consistent with data)</font>
    <font color="blue"># Refinement levels : [2,6]; max level = 3; num_cells = [30,30]</font>
    <font color="blue"># rcl : resolution of the coarsest level in this figure</font>
    rcl = 1    <font color="blue"># rcl*figsize = num_cells</font>
    plotfigure.kml_figsize = [30.0,30.0]
    plotfigure.kml_dpi = rcl*2*6         <font color="blue"># Resolve all three levels</font>
    plotfigure.kml_tile_images = False    <font color="blue"># Tile images for faster loading.  Requires GDAL [False]</font>


    <font color="blue"># Water</font>
    plotaxes = plotfigure.new_plotaxes('kml')
    plotitem = plotaxes.new_plotitem(plot_type='2d_pcolor')
    plotitem.plot_var = geoplot.surface_or_depth
    plotitem.pcolor_cmap = cmap
    plotitem.pcolor_cmin = cmin
    plotitem.pcolor_cmax = cmax

    def kml_colorbar(filename):
        geoplot.kml_build_colorbar(filename,cmap,cmin,cmax)

    plotfigure.kml_colorbar = kml_colorbar

    <font color="blue">#-----------------------------------------------------------</font>
    <font color="blue"># Figure for KML files (zoom)</font>
    <font color="blue">#----------------------------------------------------------</font>
    plotfigure = plotdata.new_plotfigure(name='Sea Surface (zoom)',figno=2)
    plotfigure.show = True

    plotfigure.use_for_kml = True
    plotfigure.kml_use_for_initial_view = False  <font color="blue"># Use large plot for view</font>

    <font color="blue"># Set Google Earth bounding box and figure size</font>
    plotfigure.kml_xlimits = [-84,-74]
    plotfigure.kml_ylimits = [-18,-4]
    plotfigure.kml_figsize = [10,14]  <font color="blue"># inches.</font>

    <font color="blue"># Resolution</font>
    rcl = 10    <font color="blue"># Over-resolve the coarsest level</font>
    plotfigure.kml_dpi = rcl*2*6       <font color="blue"># Resolve all three levels</font>
    plotfigure.kml_tile_images = False  <font color="blue"># Tile images for faster loading.</font>


    plotaxes = plotfigure.new_plotaxes('kml')
    plotitem = plotaxes.new_plotitem(plot_type='2d_pcolor')
    plotitem.plot_var = geoplot.surface_or_depth
    plotitem.pcolor_cmap = cmap
    plotitem.pcolor_cmin = cmin
    plotitem.pcolor_cmax = cmax

    def kml_colorbar(filename):
        geoplot.kml_build_colorbar(filename,cmap,cmin,cmax)

    plotfigure.kml_colorbar = kml_colorbar


    <font color="blue">#-----------------------------------------</font>
    <font color="blue"># Figures for gauges</font>
    <font color="blue">#-----------------------------------------</font>
    plotfigure = plotdata.new_plotfigure(name='Surface at gauges', figno=300, \
                    type='each_gauge')
    plotfigure.clf_each_gauge = True

    <font color="blue"># Set up for axes in this figure:</font>
    plotaxes = plotfigure.new_plotaxes()
    plotaxes.xlimits = 'auto'
    plotaxes.ylimits = 'auto'
    <font color="blue"># plotaxes.title = 'Surface'</font>

    <font color="blue"># Plot surface as blue curve:</font>
    plotitem = plotaxes.new_plotitem(plot_type='1d_plot')
    plotitem.plot_var = 3
    plotitem.plotstyle = 'b-'

    <font color="blue"># Plot topo as green curve:</font>
    plotitem = plotaxes.new_plotitem(plot_type='1d_plot')
    plotitem.show = True

    def gaugetopo(current_data):
        q = current_data.q
        h = q[0,:]
        eta = q[3,:]
        topo = eta - h
        return topo

    plotitem.plot_var = gaugetopo
    plotitem.plotstyle = 'g-'

    def add_zeroline(current_data):
        from pylab import plot, legend, xticks, floor, axis, xlabel
        t = current_data.t
        gaugeno = current_data.gaugeno

        if gaugeno == 32412:
            try:
                plot(TG32412[:,0], TG32412[:,1], 'r')
                legend(['GeoClaw','Obs'],loc='lower right')
            except: pass
            axis((0,t.max(),-0.3,0.3))

        plot(t, 0*t, 'k')
        n = int(floor(t.max()/3600.) + 2)
        xticks([3600*i for i in range(n)], ['%i' % i for i in range(n)])
        xlabel('time (hours)')

    plotaxes.afteraxes = add_zeroline


    <font color="blue">#-----------------------------------------</font>

    <font color="blue"># Parameters used only when creating html and/or latex hardcopy</font>
    <font color="blue"># e.g., via pyclaw.plotters.frametools.printframes:</font>

    plotdata.printfigs = True                <font color="blue"># print figures</font>
    plotdata.print_format = 'png'            <font color="blue"># file format</font>
    plotdata.print_framenos = 'all'         <font color="blue"># list of frames to print</font>
    plotdata.print_gaugenos = 'all'          <font color="blue"># list of gauges to print</font>
    plotdata.print_fignos = 'all'           <font color="blue"># list of figures to print</font>
    plotdata.html = False                     <font color="blue"># create html files of plots?</font>
    plotdata.html_movie = None                     <font color="blue"># create html files of plots?</font>
    plotdata.html_homelink = '../README.html'   <font color="blue"># pointer for top of index</font>
    plotdata.latex = False                    <font color="blue"># create latex file of plots?</font>
    plotdata.latex_figsperline = 2           <font color="blue"># layout of plots</font>
    plotdata.latex_framesperline = 1         <font color="blue"># layout of plots</font>
    plotdata.latex_makepdf = False           <font color="blue"># also run pdflatex?</font>

    plotdata.kml = True

    return plotdata
</pre></html>
